<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>ICIP | Charlie Lehman</title>
    <link>https://charlielehman.github.io/tag/icip/</link>
      <atom:link href="https://charlielehman.github.io/tag/icip/index.xml" rel="self" type="application/rss+xml" />
    <description>ICIP</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Wed, 28 Oct 2020 08:00:00 +0000</lastBuildDate>
    <image>
      <url>https://charlielehman.github.io/images/icon_hu0b7a4cb9992c9ac0e91bd28ffd38dd00_9727_512x512_fill_lanczos_center_2.png</url>
      <title>ICIP</title>
      <link>https://charlielehman.github.io/tag/icip/</link>
    </image>
    
    <item>
      <title>Robustness and Overfitting Behavior of Implicit Background Models</title>
      <link>https://charlielehman.github.io/talk/icip2020-robustness-and-overfitting/</link>
      <pubDate>Wed, 28 Oct 2020 08:00:00 +0000</pubDate>
      <guid>https://charlielehman.github.io/talk/icip2020-robustness-and-overfitting/</guid>
      <description></description>
    </item>
    
    <item>
      <title>On the Structures of Representation for the Robustness of Semantic Segmentation to Input Corruption</title>
      <link>https://charlielehman.github.io/talk/icip2020-on-the-structures/</link>
      <pubDate>Tue, 27 Oct 2020 09:30:00 +0000</pubDate>
      <guid>https://charlielehman.github.io/talk/icip2020-on-the-structures/</guid>
      <description></description>
    </item>
    
    <item>
      <title>S6:Semi-Supervised Self-Supervised Semantic Segmentation</title>
      <link>https://charlielehman.github.io/talk/icip2020-s6/</link>
      <pubDate>Tue, 27 Oct 2020 09:00:00 +0000</pubDate>
      <guid>https://charlielehman.github.io/talk/icip2020-s6/</guid>
      <description></description>
    </item>
    
    <item>
      <title>On the Structures of Representation for the Robustness of Semantic Segmentation to Input Corruption</title>
      <link>https://charlielehman.github.io/post/on-the-structures-of-representation/</link>
      <pubDate>Thu, 22 Oct 2020 00:00:00 +0000</pubDate>
      <guid>https://charlielehman.github.io/post/on-the-structures-of-representation/</guid>
      <description>&lt;h2 id=&#34;introduction&#34;&gt;Introduction&lt;/h2&gt;
&lt;p&gt;I wanted to provide some additional resources beyond the above linked paper and code to reproduce our results.  Below is &lt;strong&gt;mostly&lt;/strong&gt; the same code provided in the repository&amp;mdash;things like prints, form renderings for Google Colab, and rendered tqdm progress bars have been removed.  Please be sure to expand the &amp;ldquo;show code &amp;gt;&amp;rdquo; buttons to look at the code that generated the corresponding outputs/results.&lt;/p&gt;
&lt;h3 id=&#34;general-imports-and-visualiztion-methods&#34;&gt;General Imports and Visualiztion methods&lt;/h3&gt;
&lt;p&gt;We will be importing some of the required libraries here and build out the machinery for visualizing the results of this work.  Of note in &lt;code&gt;colorize_voc_label&lt;/code&gt;, is assigning the color white to classes above 20.  This is to account for 255 being used to indicate the &amp;ldquo;ignore&amp;rdquo; class. For &lt;code&gt;visualize&lt;/code&gt;, the assumption is the arguments are &lt;code&gt;torch.Tensor&lt;/code&gt; instances that are the outputs of our models.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; np
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; torch
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; functools &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; partial
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; os
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; PIL &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Image
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib
&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;matplotlib inline
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pyplot &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; plt
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; gridspec
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; cm
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib.colors &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; ListedColormap, LinearSegmentedColormap

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;colorize_voc_label&lt;/span&gt;(lbl):
    voc_colors &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  [[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;],
                   [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;],
                   [&lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;],
                   [&lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;],
                   [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], [&lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;192&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;],
                   [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;64&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;128&lt;/span&gt;]]
    voc_colors &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(voc_colors)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;
    voc_cmap &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ListedColormap(voc_colors)
    cmap_lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; voc_cmap(lbl&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;)
    cmap_lbl[lbl&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,:&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; cmap_lbl


&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;visualize&lt;/span&gt;(im, lbl, pred&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;None):
    im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
    lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;squeeze()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
    cols &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; pred &lt;span style=&#34;color:#f92672&#34;&gt;is&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;not&lt;/span&gt; None &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
    fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,cols)
    im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ((im&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;std&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;astype(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;uint8)
    ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(im)
    ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_title(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Image&amp;#39;&lt;/span&gt;)
    ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(colorize_voc_label(lbl))
    ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_title(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Label&amp;#39;&lt;/span&gt;)
    ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
    ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; pred &lt;span style=&#34;color:#f92672&#34;&gt;is&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;not&lt;/span&gt; None:
        pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pred&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;squeeze()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
        ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(colorize_voc_label(pred))
        ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_title(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Pred&amp;#39;&lt;/span&gt;)
        ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; fig, ax&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;segmentation-transforms&#34;&gt;Segmentation Transforms&lt;/h3&gt;
&lt;p&gt;Now we build out the joint transform used during training and validation that is compatible with &lt;code&gt;torchvision.datasets.VOCSegmentation&lt;/code&gt;.  This requires the &lt;code&gt;joint_transforms&lt;/code&gt; module provided in the above linked code.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; transforms
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; joint_transforms

MEAN_STD &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;mean&amp;#34;&lt;/span&gt;:(&lt;span style=&#34;color:#ae81ff&#34;&gt;0.485&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.456&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.406&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;std&amp;#34;&lt;/span&gt;:(&lt;span style=&#34;color:#ae81ff&#34;&gt;0.229&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.224&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.225&lt;/span&gt;)}

base_size &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;
crop_size &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ImLblTransform&lt;/span&gt;(object):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, train):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_train &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
        im_tran &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  [
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ToTensor(), 
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normalize(&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;MEAN_STD)
        ]
        
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; train:
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_train&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(joint_transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;RandomScaleCrop(base_size, crop_size, fill&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;))
            im_tran&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;insert(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ColorJitter(brightness&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.3&lt;/span&gt;, contrast&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.3&lt;/span&gt;, saturation&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.3&lt;/span&gt;, hue&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.1&lt;/span&gt;)) 
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_train&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(joint_transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;FixScaleResize(base_size))
            
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;img_transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Compose(im_tran)
            
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __call__(self, img, lbl):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; tfm &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_train:
            img, lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tfm(img, lbl)
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;img_transform(img)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;astype(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float32)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;from_numpy(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; img, lbl&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;voc2012&#34;&gt;VOC2012&lt;/h3&gt;
&lt;p&gt;Now to put our &lt;code&gt;visualize&lt;/code&gt; method to work, we can look at the first image and label pair in the VOC2012 training set.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.datasets &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; VOCSegmentation

voc_train &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; VOCSegmentation(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/&amp;#39;&lt;/span&gt;, transforms&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ImLblTransform(True))
voc_val &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; VOCSegmentation(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/&amp;#39;&lt;/span&gt;, transforms&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ImLblTransform(False), image_set&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val&amp;#39;&lt;/span&gt;)
im_,lbl_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; voc_train[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; visualize(im_,lbl_)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_8_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;sbd&#34;&gt;SBD&lt;/h3&gt;
&lt;p&gt;Next, we want to append the VOC2012 training set with the &amp;ldquo;train_noval&amp;rdquo; subset of SBDataset as provided by torchvision to have a total of 7087 training examples. Notice as we visualize an example from SBDataset that they differ in that the transitions from foreground to background is not bordered by the &amp;ldquo;ignore&amp;rdquo; class.&lt;/p&gt;
&lt;p&gt;
&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.datasets &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; SBDataset

sbd_train &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; SBDataset(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/SBD&amp;#39;&lt;/span&gt;, image_set&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;train_noval&amp;#39;&lt;/span&gt;, 
                      mode&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;segmentation&amp;#39;&lt;/span&gt;, transforms&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ImLblTransform(True))
im_,lbl_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sbd_train[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; visualize(im_,lbl_)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;img src=&#34;index_10_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;dataloader&#34;&gt;Dataloader&lt;/h3&gt;
&lt;p&gt;Now to bring the datasets together for use in training and validation.  If you will be implementing this yourself, note that we used a batch size of 20, which may exceed the memory available on your GPU.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torch.utils &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; data

vocsbd_train &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ConcatDataset([voc_train, sbd_train])

train_iter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader(vocsbd_train, batch_size&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;, shuffle&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True, 
                             num_workers&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;, pin_memory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True, drop_last&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True)

STEPS_PER_EPOCH &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; len(train_iter)

&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Steps per Epoch: {}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(STEPS_PER_EPOCH))

val_iter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader(voc_val, batch_size&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, shuffle&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;False, 
                             num_workers&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;, pin_memory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;pre&gt;&lt;code&gt;Steps per Epoch: 354
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;corruptions&#34;&gt;Corruptions&lt;/h3&gt;
&lt;h4 id=&#34;corruptions-to-transform&#34;&gt;Corruptions to Transform&lt;/h4&gt;
&lt;p&gt;In order to use the machinery in &lt;code&gt;pytorch&lt;/code&gt; we wrapped the corruption methods from the &lt;a href=&#34;https://pypi.org/project/imagenet-c/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;imagenet-c&lt;/a&gt; package in the standard &lt;code&gt;pytorch&lt;/code&gt; transform interface. ImageNet-C is part of a collection of work on studying the impacts of corruptions by Dan Hendrycks, Thomas Dietterich, and others. More details can be found on the &lt;a href=&#34;https://github.com/hendrycks/robustness&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ImageNet-C Repository&lt;/a&gt;.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; imagenet_c &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; corrupt, corruption_tuple
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; functools &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; partial
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; itertools &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; product &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; iterprod
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; PIL &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Image

corr_dict &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {}
[corr_dict&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update({p&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__name__&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]:n}) &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; n,p &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(corruption_tuple[:&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;])]
&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(corr_dict)

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ImLblCorruptTransform&lt;/span&gt;(object):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, severity, corruption_number):
        corrupt_partial &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; partial(corrupt, severity&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;severity, corruption_number&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;corruption_number)
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; joint_transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;FixedResize(&lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;)
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; sz: transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Compose(
            [
            np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array,
            corrupt_partial,
            Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fromarray,
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Resize(sz),
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ToTensor(), 
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normalize(&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;MEAN_STD),
            ]
        )
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; severity &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; sz: transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Compose(
                [
                transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ToTensor(), 
                transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normalize(&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;MEAN_STD)   
                ]
            )
        
            
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __call__(self, img, lbl):
        img, lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_transform(img,lbl)
        W,H &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; img&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;size
        sz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (H,W)
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform(sz)(img)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;astype(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float32)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;from_numpy(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; img, lbl&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;pre&gt;&lt;code&gt;{
&#39;gaussian&#39;: 0, &#39;shot&#39;: 1, 
&#39;impulse&#39;: 2, &#39;defocus&#39;: 3, 
&#39;glass&#39;: 4, &#39;motion&#39;: 5, 
&#39;zoom&#39;: 6, &#39;snow&#39;: 7, 
&#39;frost&#39;: 8, &#39;fog&#39;: 9, 
&#39;brightness&#39;: 10, &#39;contrast&#39;: 11, 
&#39;elastic&#39;: 12, &#39;pixelate&#39;: 13, 
&#39;jpeg&#39;: 14
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;voc-corruptions-4567&#34;&gt;VOC Corruptions 4,5,6,7&lt;/h4&gt;
&lt;p&gt;Glass, Motion, Zoom and Snow take a long time for each iteration, so we can gain efficiencies by preprocessing these at all corruption levels.  To do so, use the provided script &lt;code&gt;dump_voc_c.py&lt;/code&gt; with the desired corruption number and severity.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; datasets &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; dsets
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torch.utils.data &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Dataset, DataLoader
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; PIL &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Image
MEAN_STD &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;mean&amp;#34;&lt;/span&gt;:(&lt;span style=&#34;color:#ae81ff&#34;&gt;0.485&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.456&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.406&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;std&amp;#34;&lt;/span&gt;:(&lt;span style=&#34;color:#ae81ff&#34;&gt;0.229&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.224&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.225&lt;/span&gt;)}

    
&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;d_4567&lt;/span&gt;(Dataset):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, cn, sv):
        name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; corruption_tuple[cn]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__name__
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; name
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sv &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sv
        imgdir &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;VOC-C/{}/{}/&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(name,sv)
        lbldir &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;VOC-C/lbl/&amp;#39;&lt;/span&gt;
        
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;img_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [imgdir&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;f &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; f &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;listdir(imgdir)]
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lbl_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [lbldir&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;f &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; f &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;listdir(lbldir)]
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Compose(
            [
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ToTensor(), 
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normalize(&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;MEAN_STD)   
            ]
        )
        

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __len__(self):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; len(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;img_list)

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __getitem__(self, idx):
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;open(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;img_list[idx])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;convert(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;RGB&amp;#39;&lt;/span&gt;)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;open(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lbl_list[idx])
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform(img)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;astype(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float32)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;from_numpy(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; img, lbl
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __str__(self):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{} @ {}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;name, self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sv)
    
    
d_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; d_4567(&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(d_)
im,lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; d_[&lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;]
fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; visualize(im,lbl)
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;pre&gt;&lt;code&gt;motion_blur @ 4
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;index_20_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;visualize-corruptions&#34;&gt;Visualize Corruptions&lt;/h4&gt;
&lt;p&gt;Here&amp;rsquo;s what the different corruption levels look like for a subset of the corruptions.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;687&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#@param {type:&amp;#34;integer&amp;#34;}&lt;/span&gt;
image_set &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;val&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#@param [&amp;#34;val&amp;#34;, &amp;#34;train&amp;#34;]&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; imagenet_c &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; corrupt, corruption_tuple
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; PIL &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; Image
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; numpy &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; np
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; gridspec

dataset &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; VOCSegmentation(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/&amp;#39;&lt;/span&gt;, image_set&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;image_set)
im_,lbl_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dataset[index]
w, h &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;size
new_h &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;
new_low_h &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;
new_w &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;150&lt;/span&gt;
ratio &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;h
s &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;
fig &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;figure(figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(s&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;ratio, s))
gs1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; gridspec&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;GridSpec(&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;)
gs1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update(wspace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.05&lt;/span&gt;, hspace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.05&lt;/span&gt;)
orig_size &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;size
i &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;]:
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; severity &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;]:
        corrim &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fromarray(corrupt(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(im_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;resize((&lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)), 
                                         severity&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;severity,
                                         corruption_number&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cn))&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;resize(orig_size)
        &lt;span style=&#34;color:#75715e&#34;&gt;#corrim2 = corrim.crop((w//2-new_w//2,new_h,w//2+new_w//2,h-new_low_h))&lt;/span&gt;
        ax1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplot(gs1[i])
        ax1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_xticklabels([])
        ax1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_yticklabels([])
        ax1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;grid(False)
        ax1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(corrim)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; severity&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:
            corname &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; str(corruption_tuple[cn]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__name__)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
            ax1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_ylabel(corname)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; cn&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
            ax1&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_title(severity)
            
        i&lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
    
        
display()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_22_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;metrics&#34;&gt;Metrics&lt;/h2&gt;
&lt;h3 id=&#34;running-confusion-matrix&#34;&gt;Running Confusion Matrix&lt;/h3&gt;
&lt;p&gt;This will allow us to get metrics while running through with batches during training or in aggregate across the entire validation set.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; torch.nn.functional &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; F
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; confusion_matrix &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; conf_mat 

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;RunningConfusionMatrix&lt;/span&gt;(object):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, num_classes, ignore_class&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;None):
        super(RunningConfusionMatrix, self)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__init__()
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; num_classes
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ignore_class &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ignore_class
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset()

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __call__(self, prediction, target):
        prediction &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; prediction&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;view(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; target&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;view(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ignore_class &lt;span style=&#34;color:#f92672&#34;&gt;is&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;not&lt;/span&gt; None:
            prediction &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; prediction[target&lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt;self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ignore_class]
            target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; target[target&lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt;self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ignore_class]
            prediction &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; prediction[prediction&lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt;self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ignore_class]
            target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; target[prediction&lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt;self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ignore_class]
            
        prediction_oh &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; F&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;one_hot(prediction, self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()
        target_oh &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; F&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;one_hot(target&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;long(), self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()
        _cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; target_oh&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mm(prediction_oh)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;long()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cm &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; _cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()
    
    &lt;span style=&#34;color:#a6e22e&#34;&gt;@property&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;acc&lt;/span&gt;(self):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diag()&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
        
    &lt;span style=&#34;color:#a6e22e&#34;&gt;@property&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;iou&lt;/span&gt;(self):
        tp &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diag()
        fp &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; tp
        fn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; tp
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; tp&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(tp&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;fp&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;fn)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;reset&lt;/span&gt;(self):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes, self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h2 id=&#34;experiment&#34;&gt;Experiment&lt;/h2&gt;
&lt;h3 id=&#34;trainer&#34;&gt;Trainer&lt;/h3&gt;
&lt;p&gt;Here is a configurable implementation of a semantic segmentation experiment.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; utils
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; IPython.display &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; display, clear_output
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; tqdm.notebook &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; tqdm
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torch &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; nn

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;SemanticSegmentation&lt;/span&gt;(object):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, config):
        
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cuda &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;]
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;one_hot &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;one_hot&amp;#39;&lt;/span&gt;]
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;device &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cuda &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;confusion_matrix &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningConfusionMatrix(config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_classes&amp;#39;&lt;/span&gt;], &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
        
        model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
        criterion &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;criterion&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;criterion&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
        
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optimizer &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;optimizer&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;]([
           {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;params&amp;#39;&lt;/span&gt;:model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backbone&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;parameters()},
           {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;params&amp;#39;&lt;/span&gt;:model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;classifier&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;parameters(), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;lr&amp;#39;&lt;/span&gt;:config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;optimizer&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;lr&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;},
        ],&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;optimizer&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;train_iter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;train_iter&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;train_iter&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;val_iter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val_iter&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val_iter&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
        
        
        
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cuda:
            &lt;span style=&#34;color:#75715e&#34;&gt;#self.model = DataParallelModel(model.to(self.device), device_ids=[0,1])&lt;/span&gt;
            &lt;span style=&#34;color:#75715e&#34;&gt;#self.criterion = DataParallelCriterion(criterion.to(self.device), device_ids=[0,1])&lt;/span&gt;
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataParallel(model, device_ids&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cuda()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;criterion &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; criterion
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; model
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;criterion &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; criterion
        
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;steps &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;epoch_n &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;config &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; config
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;evaluator&lt;/span&gt;(self):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;pass&lt;/span&gt;
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;step&lt;/span&gt;(self, input, target, oh_target):
        name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Train&amp;#39;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;training &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Val&amp;#39;&lt;/span&gt;
        output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model(input)
        pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;confusion_matrix(pred, target)
        iou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;confusion_matrix&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iou
        miou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; iou[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isnan(iou)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;training:
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;confusion_matrix&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset()
            loss &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;criterion(output, oh_target &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;one_hot &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; target&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;long())&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optimizer&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zero_grad()
            loss&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backward()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optimizer&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;step()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;steps &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
            _loss &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; loss&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;item()
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            _loss &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tbar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_description(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;[{} - {}] Loss: {:.3f}, mIOU: {:.3f}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;epoch_n, name, _loss, miou))
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; pred&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;epoch&lt;/span&gt;(self, data_iter):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tbar &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tqdm(data_iter)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; input, target &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tbar:
            _target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; target&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;clone()
            _target[target&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
            oh_target &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;functional&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;one_hot(_target&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;long(),&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()
            pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;step(input&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;device), 
                               target&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;device), 
                               oh_target&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;device))

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;train&lt;/span&gt;(self, num_epochs, lr_sched&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; lr_sched:
            poly &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; step: (&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; step&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;num_epochs)&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.9&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            poly &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; step: &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; 
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lr_scheduler &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optim&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lr_scheduler&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;LambdaLR(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optimizer, lr_lambda&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;poly)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; n &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(num_epochs):
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;epoch_n &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;train()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;epoch(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;train_iter)
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;validate_while_train&amp;#39;&lt;/span&gt;]:
                self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;validate()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lr_scheduler&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;step()
            
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;validate&lt;/span&gt;(self):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;confusion_matrix&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset()
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;epoch(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;val_iter)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;visualize&lt;/span&gt;(self, input, target, pred):
        fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; visualize(input[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], target[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], pred[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h2 id=&#34;models&#34;&gt;Models&lt;/h2&gt;
&lt;p&gt;Below we prepare three versions of the DeepLab v3+ with ResNet50 backbone: vanilla, Implicit Background Estimation (IBE), and Sigmoid Cross Entropy Implicit Background Estimation (SCrIBE).  Since the  models are trained from an ImageNet pretrained ResNet50, the appropriate layers are replaced and wrapped in an &lt;code&gt;nn.Module&lt;/code&gt;. We then train each model using the previously introduced configurable experiment.&lt;/p&gt;
&lt;h3 id=&#34;deeplabv3&#34;&gt;DeepLabV3+&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.models.segmentation &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; deeplabv3_resnet50
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.models &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; resnet50
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.models._utils &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; IntermediateLayerGetter
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torch &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; nn

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DLv3_ResNet50&lt;/span&gt;(nn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Module):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, num_classes&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;):
        super(DLv3_ResNet50, self)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__init__()
        model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; deeplabv3_resnet50(num_classes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; num_classes)
        backbone &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; resnet50(pretrained&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True, replace_stride_with_dilation&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[False, True, True])
        return_layers &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;layer4&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;out&amp;#39;&lt;/span&gt;}
        model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backbone &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; IntermediateLayerGetter(backbone, return_layers&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;return_layers)
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backbone &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backbone
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;classifier &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;classifier
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;forward&lt;/span&gt;(self,x):
        input_shape &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;:]
        features &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backbone(x)
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; features[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;out&amp;#34;&lt;/span&gt;]
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;classifier(x)
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; F&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;interpolate(x, size&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;input_shape, mode&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bilinear&amp;#39;&lt;/span&gt;, align_corners&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;False)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; x
    
    
ns_config &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_classes&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;one_hot&amp;#39;&lt;/span&gt;:False,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;:True,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;validate_while_train&amp;#39;&lt;/span&gt;:True,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:DLv3_ResNet50,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_classes&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;,
        },
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;criterion&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:nn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;CrossEntropyLoss,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ignore_index&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;,
        },
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;optimizer&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;: torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optim&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;SGD,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;lr&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;0.01&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;momentum&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;0.9&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;weight_decay&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;5e-5&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nesterov&amp;#39;&lt;/span&gt;:False
        },
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;train_iter&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dataset&amp;#39;&lt;/span&gt;:vocsbd_train,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;batch_size&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shuffle&amp;#39;&lt;/span&gt;:True,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_workers&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pin_memory&amp;#39;&lt;/span&gt;:True,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;drop_last&amp;#39;&lt;/span&gt;:True,
        }
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val_iter&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dataset&amp;#39;&lt;/span&gt;:voc_val,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;batch_size&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shuffle&amp;#39;&lt;/span&gt;:False,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_workers&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pin_memory&amp;#39;&lt;/span&gt;:False,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;drop_last&amp;#39;&lt;/span&gt;:False,
        }
    }
}

pth &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;data/DLv3_ResNet50.pth&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;  os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isfile(pth):
    no_scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ns_config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;ns_config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
    no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load_state_dict(torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load(pth))
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
    no_scribe_experiment &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; SemanticSegmentation(ns_config)
    no_scribe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;train(&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;, True)
    no_scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;module
    torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save(no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_dict(), pth)
    no_scribe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;validate()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;deeplabv3ibe&#34;&gt;DeepLabV3+IBE&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DLv3_ResNet50_IBE&lt;/span&gt;(DLv3_ResNet50):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, num_classes&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;):
        super(DLv3_ResNet50_IBE, self)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__init__(num_classes&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;num_classes)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;forward&lt;/span&gt;(self,x):
        input_shape &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;:]
        features &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backbone(x)
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; features[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;out&amp;#34;&lt;/span&gt;]
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;classifier(x)
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cat([&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;logsumexp(x,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, keepdim&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True),x],&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; F&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;interpolate(x, size&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;input_shape, mode&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bilinear&amp;#39;&lt;/span&gt;, align_corners&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;False)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; x
    
i_config &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_classes&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;one_hot&amp;#39;&lt;/span&gt;:False,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;:True,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;validate_while_train&amp;#39;&lt;/span&gt;:True,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:DLv3_ResNet50_IBE,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_classes&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,
        },
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;criterion&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:nn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;CrossEntropyLoss,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ignore_index&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;,
        },
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;optimizer&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;: torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optim&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;SGD,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;lr&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;0.01&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;momentum&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;0.9&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;weight_decay&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;5e-5&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nesterov&amp;#39;&lt;/span&gt;:False
        }
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;train_iter&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dataset&amp;#39;&lt;/span&gt;:vocsbd_train,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;batch_size&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shuffle&amp;#39;&lt;/span&gt;:True,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_workers&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pin_memory&amp;#39;&lt;/span&gt;:True,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;drop_last&amp;#39;&lt;/span&gt;:True,
        }
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val_iter&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dataset&amp;#39;&lt;/span&gt;:voc_val,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;batch_size&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shuffle&amp;#39;&lt;/span&gt;:False,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_workers&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pin_memory&amp;#39;&lt;/span&gt;:False,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;drop_last&amp;#39;&lt;/span&gt;:False,
        }
    }
}

pth &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;data/DLv3_IBE.pth&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;  os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isfile(pth):
    ibe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;i_config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
    ibe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load_state_dict(torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load(pth))
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
    ibe_experiment &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; SemanticSegmentation(i_config)
    ibe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;train(&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;, True)
    ibe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ibe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;module
    torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save(ibe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_dict(), pth)
    ibe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;validate()
    
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;deeplabv3scribe&#34;&gt;DeepLabV3+ScrIBE&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DLv3_ResNet50_SCrIBE&lt;/span&gt;(DLv3_ResNet50):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, num_classes&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;):
        super(DLv3_ResNet50_SCrIBE, self)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__init__(num_classes&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;num_classes)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;forward&lt;/span&gt;(self,x):
        input_shape &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;:]
        _x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;backbone(x)
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;classifier(_x[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;out&amp;#34;&lt;/span&gt;])
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cat([&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;logsumexp(x,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, keepdim&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True),x],&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; F&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;interpolate(x, size&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;input_shape, mode&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bilinear&amp;#39;&lt;/span&gt;, align_corners&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;False)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; x
    
    
s_config &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_classes&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;one_hot&amp;#39;&lt;/span&gt;:True,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;:True,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;validate_while_train&amp;#39;&lt;/span&gt;:True,
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:DLv3_ResNet50_SCrIBE,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_classes&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,
        },
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;criterion&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:nn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;BCEWithLogitsLoss,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
        },
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;optimizer&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;: torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;optim&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;SGD,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;lr&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;0.01&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;momentum&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;0.9&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;weight_decay&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;5e-5&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;nesterov&amp;#39;&lt;/span&gt;:False
        }
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;train_iter&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dataset&amp;#39;&lt;/span&gt;:vocsbd_train,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;batch_size&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shuffle&amp;#39;&lt;/span&gt;:True,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_workers&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pin_memory&amp;#39;&lt;/span&gt;:True,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;drop_last&amp;#39;&lt;/span&gt;:True,
        }
    },
    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val_iter&amp;#39;&lt;/span&gt;:{
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;:data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader,
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;:{
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;dataset&amp;#39;&lt;/span&gt;:voc_val,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;batch_size&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;shuffle&amp;#39;&lt;/span&gt;:False,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;num_workers&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;pin_memory&amp;#39;&lt;/span&gt;:False,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;drop_last&amp;#39;&lt;/span&gt;:False,
        }
    }
}

pth &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;data/DLv3_SCrIBE.pth&amp;#39;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt;  os&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;path&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isfile(pth):
    scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;class&amp;#39;&lt;/span&gt;](&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;s_config[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;kwargs&amp;#39;&lt;/span&gt;])
    scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load_state_dict(torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;load(pth))
&lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
    scribe_experiment &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; SemanticSegmentation(s_config)
    scribe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;train(&lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;, True)
    scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;module
    torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save(scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;state_dict(), pth)
    scribe_experiment&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;validate()
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h2 id=&#34;representation-metrics&#34;&gt;Representation Metrics&lt;/h2&gt;
&lt;h3 id=&#34;running-logit-tracker&#34;&gt;Running Logit Tracker&lt;/h3&gt;
&lt;p&gt;Much like the Running Confusion Matrix, we will also track the logits or pre-softmax model outputs over a run of batched iterations for later analysis.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;RunningLogitTracker&lt;/span&gt;(object):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, num_classes, ignore_class&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;None):
        super(RunningLogitTracker, self)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__init__()
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; num_classes
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ignore_class &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ignore_class
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reset()

    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __call__(self, output):
        output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reshape(&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes)
        _pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; n &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes):
            x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; output[_pred&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;n,:]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;detach()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;counts[n] &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;size(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sums[n] &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sumsqs[n] &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; x&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mm(x)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()
        
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;dist&lt;/span&gt;(self,x,y):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; (x&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;y)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;pow(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sum()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sqrt()
    
    &lt;span style=&#34;color:#a6e22e&#34;&gt;@property&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;dm&lt;/span&gt;(self):
        _dm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes, self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes)
        mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes):
            &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; j &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(i,self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes):
                _dm[i,j] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dist(mn[i], mn[j])
                _dm[j,i] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; _dm[i,j]
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; _dm
        
    &lt;span style=&#34;color:#a6e22e&#34;&gt;@property&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;mean&lt;/span&gt;(self):
        out &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sums&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;counts&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        out[out&lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt;out] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; out
    
    &lt;span style=&#34;color:#a6e22e&#34;&gt;@property&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cov&lt;/span&gt;(self):
        covs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; n &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes):
            mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean[n]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
            sq &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sumsqs[n]
            _cov &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (sq &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt; mn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mm(mn))&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;counts[n]
            _cov[_cov&lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt;_cov] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
            covs&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(_cov)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stack(covs,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
    
    &lt;span style=&#34;color:#a6e22e&#34;&gt;@property&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;cor&lt;/span&gt;(self):
        covs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cov
        cors &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; n &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes):
            S &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; covs[n]
            Dinv &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;inverse(S&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diag()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diag()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sqrt())
            R &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Dinv&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mm(S)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mm(Dinv)
            cors&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(R)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stack(cors,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
    
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;reset&lt;/span&gt;(self):
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;counts &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes) 
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sums &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes, self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes)
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;sumsqs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;zeros(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes, self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes, self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;num_classes)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;run-over-all-corruptions-and-levels&#34;&gt;Run over all Corruptions and Levels&lt;/h3&gt;
&lt;p&gt;Here we measure the performance of each model for each corruption at each level.  This also takes a while, but has some progress saving built in.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; torch
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; gc
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; pd


batch &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;

nm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;data/DistCombined.pkl&amp;#39;&lt;/span&gt;

scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
ibe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ibe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
no_scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()
ibe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()
no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()

&lt;span style=&#34;color:#66d9ef&#34;&gt;try&lt;/span&gt;:
    dist_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_pickle(nm)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;drop_duplicates()
    lgst_cn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dist_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;corruption_number&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max()
    lgst_sv &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dist_df[dist_df[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;corruption_number&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;lgst_cn][&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Severity&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max()
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Restarting from {}@{}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(lgst_cn, lgst_sv))
    dist_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dist_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_dict(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;records&amp;#39;&lt;/span&gt;)
    flag &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; False 
&lt;span style=&#34;color:#66d9ef&#34;&gt;except&lt;/span&gt;:
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;New Run!&amp;#39;&lt;/span&gt;)
    lgst_cn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    lgst_sv &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
    dist_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
    flag &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; False 


&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(lgst_cn,&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;):
    corruption_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; corruption_tuple[cn]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__name__
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; sv &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;):
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; sv&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; flag:
            &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Case 1: Skipping {}@{}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(cn, sv))
            &lt;span style=&#34;color:#66d9ef&#34;&gt;continue&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt; lgst_cn: 
            lgst_sv&lt;span style=&#34;color:#f92672&#34;&gt;=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; sv &lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt; lgst_sv: 
            &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Case 2: Skipping {}@{}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(cn, sv))
            &lt;span style=&#34;color:#66d9ef&#34;&gt;continue&lt;/span&gt;
        s_cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningConfusionMatrix(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
        i_cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningConfusionMatrix(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
        n_cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningConfusionMatrix(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
        s_lt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningLogitTracker(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
        i_lt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningLogitTracker(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
        n_lt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningLogitTracker(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;]:
            corr_val &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; d_4567(cn,sv)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
            corr_val &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; VOCSegmentation(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/&amp;#39;&lt;/span&gt;, 
                                        transforms&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ImLblCorruptTransform(sv,cn), 
                                        image_set&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val&amp;#39;&lt;/span&gt;)

        corr_iter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader(corr_val, batch_size&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;batch, shuffle&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;False, num_workers&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, pin_memory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True)
        pbar &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tqdm(corr_iter, position&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, leave&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; im,lbl &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; pbar:
            s_output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
            i_output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ibe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
            n_output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))

            s_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
            i_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
            n_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

            s_cm(s_pred, lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
            i_cm(i_pred, lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
            n_cm(n_pred, lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))

            s_iou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iou
            s_miou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_iou[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isnan(s_iou)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
            i_iou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iou
            i_miou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_iou[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isnan(i_iou)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
            n_iou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iou
            n_miou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_iou[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isnan(n_iou)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()

            s_lt(s_output)
            i_lt(i_output)
            n_lt(n_output)


            pbar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_description(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;{}@{} S/I/B: {:.3f} / {:.3f} / {:.3f}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(cn, sv, s_miou,i_miou,n_miou))
            
        s_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
        i_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
        n_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()

        s_r &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diagonal(s_mn)[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;s_mn[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])
        i_r &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diagonal(i_mn)[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i_mn[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])
        n_r &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diagonal(n_mn)[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:]&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;n_mn[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])
        dist_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(
                    {
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Model&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ScrIBE&amp;#39;&lt;/span&gt;,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Corruption&amp;#39;&lt;/span&gt;:corruption_name,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;corruption_number&amp;#39;&lt;/span&gt;:cn,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Severity&amp;#39;&lt;/span&gt;:sv,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mIOU&amp;#39;&lt;/span&gt;:s_miou&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;item(),
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Distance&amp;#39;&lt;/span&gt;:s_r
                    }
        )
        dist_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(
                    {
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Model&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IBE&amp;#39;&lt;/span&gt;,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Corruption&amp;#39;&lt;/span&gt;:corruption_name,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;corruption_number&amp;#39;&lt;/span&gt;:cn,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Severity&amp;#39;&lt;/span&gt;:sv,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mIOU&amp;#39;&lt;/span&gt;:i_miou&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;item(),
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Distance&amp;#39;&lt;/span&gt;:i_r
                    }
        )
        dist_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(
                    {
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Model&amp;#39;&lt;/span&gt;:&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Baseline&amp;#39;&lt;/span&gt;,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Corruption&amp;#39;&lt;/span&gt;:corruption_name,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;corruption_number&amp;#39;&lt;/span&gt;:cn,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Severity&amp;#39;&lt;/span&gt;:sv,
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mIOU&amp;#39;&lt;/span&gt;:n_miou&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;item(),
                        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Distance&amp;#39;&lt;/span&gt;:n_r
                    }
        )

        dist_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame(dist_data)
        dist_df&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_pickle(nm)
        flag &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; True&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;pre&gt;&lt;code&gt;Restarting from 14@5
Case 2: Skipping 14@0
Case 2: Skipping 14@1
Case 2: Skipping 14@2
Case 2: Skipping 14@3
Case 2: Skipping 14@4
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;run-validation&#34;&gt;Run Validation&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; torch
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; gc
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; pd

torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cuda&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;empty_cache()

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;run_one&lt;/span&gt;(scribe_model, ibe_model, no_scribe_model):
    scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
    ibe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ibe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
    no_scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()
    ibe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()
    no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()

    s_cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningConfusionMatrix(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
    i_cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningConfusionMatrix(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
    n_cm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningConfusionMatrix(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
    s_lt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningLogitTracker(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
    i_lt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningLogitTracker(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)
    n_lt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; RunningLogitTracker(&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)

    corr_val &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; VOCSegmentation(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/&amp;#39;&lt;/span&gt;, 
                              transforms&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ImLblTransform(False), 
                              image_set&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val&amp;#39;&lt;/span&gt;)

    corr_iter &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataLoader(corr_val, batch_size&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, shuffle&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;False, num_workers&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, pin_memory&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True)
    pbar &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tqdm(corr_iter, position&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, leave&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; im,lbl &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; pbar:
        s_output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
        i_output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ibe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
        n_output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))

        s_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        i_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        n_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)

        s_cm(s_pred, lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
        i_cm(i_pred, lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
        n_cm(n_pred, lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))

        s_iou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iou
        s_miou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_iou[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isnan(s_iou)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
        i_iou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iou
        i_miou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_iou[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isnan(i_iou)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()
        n_iou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_cm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;iou
        n_miou &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_iou[&lt;span style=&#34;color:#f92672&#34;&gt;~&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;isnan(n_iou)]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean()

        s_lt(s_output)
        i_lt(i_output)
        n_lt(n_output)


        pbar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_description(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;S/I/B: {:.3f} / {:.3f} / {:.3f}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;format(s_miou,i_miou,n_miou))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; s_lt, i_lt, n_lt

s_lt, i_lt, n_lt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; run_one(scribe_model, ibe_model, no_scribe_model)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h2 id=&#34;dimensionality-analysis&#34;&gt;Dimensionality Analysis&lt;/h2&gt;
&lt;h3 id=&#34;explained-variance&#34;&gt;Explained Variance&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; sklearn.decomposition &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; PCA
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; seaborn &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; sns
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; pd

sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_style(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;whitegrid&amp;#34;&lt;/span&gt;)
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_context(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;paper&amp;#34;&lt;/span&gt;, font_scale&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.5&lt;/span&gt;, rc&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;lines.linewidth&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;2.5&lt;/span&gt;})

pca_data &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []

pca &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; PCA(n_components&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;)
pca&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(s_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean)
s_cs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pca&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;explained_variance_ratio_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cumsum()
pca &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; PCA(n_components&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;)
pca&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(i_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean)
i_cs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pca&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;explained_variance_ratio_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cumsum()
pca &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; PCA(n_components&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;21&lt;/span&gt;)
pca&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fit(n_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean)
n_cs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pca&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;explained_variance_ratio_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cumsum()
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; m, p &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; zip([&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SCrIBE&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IBE&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Baseline&amp;#39;&lt;/span&gt;],[s_cs, i_cs, n_cs]):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; x,y &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(p):
        _d &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Model&amp;#39;&lt;/span&gt;: m,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Variant&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Single&amp;#39;&lt;/span&gt;,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Component&amp;#39;&lt;/span&gt;:x,
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Explained Variance&amp;#39;&lt;/span&gt;:y
        }
        pca_data&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(_d)


pca_df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;DataFrame(pca_data)

fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;])
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lineplot(ax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax,data&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;pca_df, x&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Component&amp;#39;&lt;/span&gt;, y&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Explained Variance&amp;#39;&lt;/span&gt;, hue&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Model&amp;#39;&lt;/span&gt;, hue_order &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Baseline&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IBE&amp;#39;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SCrIBE&amp;#39;&lt;/span&gt;])&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_43_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;structural-analysis&#34;&gt;Structural Analysis&lt;/h2&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.utils &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; make_grid
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib.colors &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; LogNorm
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; seaborn &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; sns
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; mpl_toolkits.axes_grid1 &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; make_axes_locatable

sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set(style&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;whitegrid&amp;#34;&lt;/span&gt;)
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_context(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;poster&amp;#34;&lt;/span&gt;, font_scale&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.5&lt;/span&gt;, rc&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;lines.linewidth&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;2.5&lt;/span&gt;})
fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;))
s_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
i_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
n_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()

s_r &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diagonal(s_mn)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;s_mn[:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
i_r &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diagonal(i_mn)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i_mn[:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]
n_r &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;diagonal(n_mn)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;n_mn[:,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]


_mx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; max([s_mn[s_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max(), i_mn[i_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max(), n_mn[n_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max()])
_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; min([s_mn[s_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min(), i_mn[i_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min(), n_mn[n_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min()])

im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(s_mn, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(i_mn, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(n_mn, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
cbar_ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_axes([&lt;span style=&#34;color:#ae81ff&#34;&gt;0.95&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.05&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.7&lt;/span&gt;])
fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colorbar(im, cax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cbar_ax)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;show()

fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;))
s_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
i_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
n_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;dm&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()

_mx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; max([s_mn[s_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max(), i_mn[i_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max(), n_mn[n_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max()])
_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; min([s_mn[s_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min(), i_mn[i_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min(), n_mn[n_mn&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min()])

im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(s_mn, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(i_mn, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(n_mn, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
cbar_ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_axes([&lt;span style=&#34;color:#ae81ff&#34;&gt;0.95&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.05&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.7&lt;/span&gt;])
fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colorbar(im, cax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cbar_ax)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;show()

s_im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(s_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cor&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, pad_value&lt;span style=&#34;color:#f92672&#34;&gt;=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,:,:]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
i_im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(i_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cor&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, pad_value&lt;span style=&#34;color:#f92672&#34;&gt;=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,:,:]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
n_im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(n_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cor&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, pad_value&lt;span style=&#34;color:#f92672&#34;&gt;=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,:,:]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()

_mx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; max([s_im[s_im&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max(), n_im[n_im&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;max()])
_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; min([s_im[s_im&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min(), n_im[n_im&lt;span style=&#34;color:#f92672&#34;&gt;!=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;min()])

&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(_mn,_mx)

fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;14&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;))
im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(s_im, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.8&lt;/span&gt;, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(i_im, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.8&lt;/span&gt;, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(n_im, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
cbar_ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_axes([&lt;span style=&#34;color:#ae81ff&#34;&gt;0.95&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.05&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.7&lt;/span&gt;])
fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colorbar(im, cax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cbar_ax)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_44_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;index_44_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;index_44_4.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set(style&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;whitegrid&amp;#34;&lt;/span&gt;)
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_context(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;paper&amp;#34;&lt;/span&gt;, font_scale&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2.0&lt;/span&gt;, rc&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;{&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;lines.linewidth&amp;#34;&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;2.5&lt;/span&gt;})


s_im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(s_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cor[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, pad_value&lt;span style=&#34;color:#f92672&#34;&gt;=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,:,:]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
i_im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(i_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cor[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, pad_value&lt;span style=&#34;color:#f92672&#34;&gt;=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,:,:]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
n_im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(n_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cor[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;), nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;, pad_value&lt;span style=&#34;color:#f92672&#34;&gt;=-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,:,:]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()

s_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
i_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; i_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
n_mn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; n_lt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;mean&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()

_mn, _mx &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;

fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;))

ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_title(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SCrIBE&amp;#39;&lt;/span&gt;)
im1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(s_im, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)

ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_title(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;IBE&amp;#39;&lt;/span&gt;)
im2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(i_im, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)

ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_title(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Baseline&amp;#39;&lt;/span&gt;)
im3 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(n_im, vmin&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mn, vmax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;_mx, cmap&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;plasma&amp;#39;&lt;/span&gt;)

ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax[&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
cbar_ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_axes([&lt;span style=&#34;color:#ae81ff&#34;&gt;0.95&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.15&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.04&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0.70&lt;/span&gt;])
fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colorbar(im3, cax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;cbar_ax)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;show()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_45_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;qualitative-result-visualizations&#34;&gt;Qualitative Result Visualizations&lt;/h2&gt;
&lt;h3 id=&#34;make-a-list-of-images-from-validation-set&#34;&gt;Make a list of images from Validation set&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; joint_transforms &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; FixedResize

&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ImViewLblTransform&lt;/span&gt;(object):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self):
        im_tran &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  [
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ToTensor(), 
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normalize(&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;MEAN_STD)  
        ]
        
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_train &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; FixedResize(&lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;)
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;img_transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Compose(im_tran)
            
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __call__(self, img, lbl):
        img, lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;joint_train(img, lbl)
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;img_transform(img)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;astype(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float32)
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;from_numpy(lbl)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; img, lbl

voc_val &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; VOCSegmentation(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/&amp;#39;&lt;/span&gt;, 
                          transforms&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ImViewLblTransform(), 
                          image_set&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;val&amp;#39;&lt;/span&gt;)

val_set_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; im, lbl &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; list(voc_val):
    im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tensor(MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;std&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reshape(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tensor(MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reshape(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    val_set_list&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(im)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;render-100-of-them-starting-at-some-index&#34;&gt;Render 100 of them starting at some index&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;delta &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;700&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#@param {type:&amp;#34;integer&amp;#34;}&lt;/span&gt;
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.utils &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; make_grid
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib.patheffects &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; path_effects
img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stack(val_set_list[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;delta:&lt;span style=&#34;color:#ae81ff&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;delta]), nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;, padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;detach()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()

fig &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;figure(figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;))
ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_axes([&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;])
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(img)
n &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; i &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; j &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;):
        txt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;05&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;j&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;, &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;95&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;i&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,
                 n&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;delta, 
                 horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
                 verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
                 transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes
                )
        txt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_path_effects([path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Stroke(linewidth&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, foreground&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;white&amp;#39;&lt;/span&gt;),
                       path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normal()])
        n &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;show()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_49_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;generate-results-to-visualize&#34;&gt;Generate Results to Visualize&lt;/h3&gt;
&lt;p&gt;Here we pick one from the group above and collect outputs for all models and corruptions at 3 levels for visualization. Crop top and crop bottom allow for adjusting the very tall figure.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;dataset_index &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;790&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#@param {type:&amp;#34;number&amp;#34;}&lt;/span&gt;
crop_top &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;50&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#@param {type:&amp;#34;number&amp;#34;}&lt;/span&gt;
crop_bot &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;  &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#@param {type:&amp;#34;number&amp;#34;}&lt;/span&gt;
Dataset &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;val&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#75715e&#34;&gt;#@param [&amp;#34;val&amp;#34;, &amp;#34;train&amp;#34;]&lt;/span&gt;

&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; torchvision.utils &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; make_grid
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib.figure &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; figaspect
preds&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;[]
scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
no_scribe_model &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()
no_scribe_model&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;eval()
corr_disp_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;]
sv_list &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; range(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; corr_disp_list:
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; sv &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; sv_list:
        voc_val &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; VOCSegmentation(root&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;/data/datasets/&amp;#39;&lt;/span&gt;, 
                                  transforms&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ImLblCorruptTransform(sv,cn), 
                                  image_set&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;Dataset)
 
        im, lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; voc_val[dataset_index]
        c,h,w &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape
        output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
        pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; output&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;squeeze()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
        pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tensor(colorize_voc_label(pred)[:,:,:&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        
        noutput &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))
        npred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; noutput&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;squeeze()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
        npred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tensor(colorize_voc_label(npred)[:,:,:&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        lbl&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tensor(colorize_voc_label(lbl)[:,:,:&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;float()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        
        im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tensor(MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;std&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reshape(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tensor(MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;reshape(&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im[:,crop_top:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;crop_bot,:]
        pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pred[:,crop_top:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;crop_bot,:]
        npred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; npred[:,crop_top:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;crop_bot,:]
        lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; lbl[:,crop_top:&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;crop_bot,:]
        imp &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cat([im,npred,pred],&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
        preds&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(imp&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;detach()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu())
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; sv&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
            or_img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;detach()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
            or_lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;detach()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
            sm_lbl &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; nn&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;functional&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;interpolate(lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;), scale_factor&lt;span style=&#34;color:#f92672&#34;&gt;=.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;squeeze()
            sl_c,sl_h,sl_w &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sm_lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape
            oi_c,oi_h,oi_w &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; lbl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape
            mod_img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;clone()
            mod_img[:,oi_h&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;sl_h:,oi_w&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;sl_w:] &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sm_lbl
            pristine &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stack([mod_img,npred,pred]),nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
            pristine_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pristine&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;detach()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
        &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;visualize-that-collections&#34;&gt;Visualize that collections&lt;/h3&gt;
&lt;p&gt;This is the visualization code used to generate a figure in the paper.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;preds &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; torch&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;stack(preds)
preds &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; make_grid(preds,nrow&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;len(sv_list),padding&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
disp_im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; preds&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:len(corr_disp_list)&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;h&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;w:]
d_h,d_w,_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; disp_im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape
p_h,p_w,_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pristine_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape
p_w &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; d_w&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(len(sv_list)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
p_h &lt;span style=&#34;color:#f92672&#34;&gt;*=&lt;/span&gt; d_w&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;p_w
d_h &lt;span style=&#34;color:#f92672&#34;&gt;/=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;96&lt;/span&gt;
d_w &lt;span style=&#34;color:#f92672&#34;&gt;/=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;96&lt;/span&gt;
p_h &lt;span style=&#34;color:#f92672&#34;&gt;/=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;96&lt;/span&gt;
p_w &lt;span style=&#34;color:#f92672&#34;&gt;/=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;96&lt;/span&gt;
tot_h &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (d_h&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;p_h)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.7&lt;/span&gt;
tot_w &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (d_w&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;p_w)&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.8&lt;/span&gt;
plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rcParams&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;update({&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;font.size&amp;#39;&lt;/span&gt;: &lt;span style=&#34;color:#ae81ff&#34;&gt;18&lt;/span&gt;})

fig &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;figure(figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(tot_w,tot_h))
ax_ &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_axes([&lt;span style=&#34;color:#ae81ff&#34;&gt;0.1&lt;/span&gt;,d_h&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;tot_h&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0.12&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.8&lt;/span&gt;,p_h&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;tot_h])
ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(pristine_)
ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, 
         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Input&amp;#39;&lt;/span&gt;, 
         horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
         verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bottom&amp;#39;&lt;/span&gt;,
         transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes
        )
ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, 
         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Baseline&amp;#39;&lt;/span&gt;, 
         horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
         verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bottom&amp;#39;&lt;/span&gt;,
         transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes
        )
ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1.15&lt;/span&gt;, 
         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Original&amp;#39;&lt;/span&gt;, 
         horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
         verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bottom&amp;#39;&lt;/span&gt;,
         transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes,
         fontweight&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bold&amp;#39;&lt;/span&gt;
        )
ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, 
         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SCrIBE&amp;#39;&lt;/span&gt;, 
         horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
         verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bottom&amp;#39;&lt;/span&gt;,
         transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax_&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes
        )
ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;add_axes([&lt;span style=&#34;color:#ae81ff&#34;&gt;0.1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0.8&lt;/span&gt;,d_h&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;tot_h])
ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;axis(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;)
n_corr &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; len(corr_disp_list)
y_start &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;n_corr&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;))
y_step &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(n_corr)
ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(disp_im)
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; j, cn &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; enumerate(corr_disp_list):
    nm &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; corruption_tuple[cn]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__name__&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;split(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;_&amp;#39;&lt;/span&gt;)[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;capitalize()
    ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#f92672&#34;&gt;-.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;,y_start&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;y_step&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j, nm, 
             horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;,
             verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
             transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes,
            rotation&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,
             fontweight&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bold&amp;#39;&lt;/span&gt;
            )
    ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#f92672&#34;&gt;-.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;,y_start&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;y_step&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;y_step&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j, 
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Baseline&amp;#39;&lt;/span&gt;, 
             horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;,
             verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
            rotation&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,
             transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes
            )
    ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#f92672&#34;&gt;-.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;01&lt;/span&gt;,y_start&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;y_step&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;y_step&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;j, 
            &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;SCrIBE&amp;#39;&lt;/span&gt;, 
             horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;,
             verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
            rotation&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;90&lt;/span&gt;,
             transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes
            )
x_start &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(len(sv_list)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))
x_step &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;(len(sv_list)&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; sv &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; sv_list[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;:]:
    ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(x_start&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;x_step&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(sv&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, 
             sv, 
             horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
             verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bottom&amp;#39;&lt;/span&gt;,
             transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes
            )
    
ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(x_start&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;x_step&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;),&lt;span style=&#34;color:#ae81ff&#34;&gt;1.01&lt;/span&gt;, 
         &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Corrupted&amp;#39;&lt;/span&gt;, 
         horizontalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;center&amp;#39;&lt;/span&gt;,
         verticalalignment&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bottom&amp;#39;&lt;/span&gt;,
         transform&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transAxes,
         fontweight&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bold&amp;#39;&lt;/span&gt;
        )
    
display()&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_50_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;performance-comparison-plot&#34;&gt;Performance Comparison Plot&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; mpl
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; seaborn &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; sns
&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; pandas &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; pd
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_style(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;whitegrid&amp;#34;&lt;/span&gt;)
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_context(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;poster&amp;#34;&lt;/span&gt;)
df &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; pd&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;read_pickle(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;data/DistCombined.pkl&amp;#39;&lt;/span&gt;)

rgbs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [(&lt;span style=&#34;color:#ae81ff&#34;&gt;213&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;94&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;), (&lt;span style=&#34;color:#ae81ff&#34;&gt;86&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;180&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;233&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255&lt;/span&gt;), (&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;, &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;, &lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;)]

cblind &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [mpl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colors&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_hex(r) &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; r &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; rgbs]
cblind_gray &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; [mpl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colors&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to_hex(
    mpl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colors&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;hsv_to_rgb(mpl&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;colors&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;rgb_to_hsv(r) &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; r &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; rgbs]

pal &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;color_palette(cblind)
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;palplot(pal)
fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;9&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1.618&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;))
sns&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;lineplot(x&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Severity&amp;#39;&lt;/span&gt;, y&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mIOU&amp;#39;&lt;/span&gt;, data&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;df, ax&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;ax, hue&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Model&amp;#39;&lt;/span&gt;)
&lt;span style=&#34;color:#75715e&#34;&gt;#plt.legend(bbox_to_anchor=(1.05,1), loc=2, borderaxespad=0.)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;&lt;img src=&#34;index_52_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;example-videos&#34;&gt;Example Videos&lt;/h2&gt;
&lt;h3 id=&#34;load-the-video&#34;&gt;Load the video&lt;/h3&gt;
&lt;p&gt;Here we provide the code that was used to produce the introduction demo that was used in the presentation video.

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; skvideo.io  
video &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;walkAS.mp4&amp;#39;&lt;/span&gt;
videodata &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; skvideo&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;io&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;vread(f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;example_videos/{video}&amp;#39;&lt;/span&gt;)  &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;
&lt;/p&gt;
&lt;h3 id=&#34;prepare-the-corrupting-transform&#34;&gt;Prepare the corrupting transform&lt;/h3&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;class&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;ImCorruptTransform&lt;/span&gt;(object):
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __init__(self, severity, corruption_number, red_size):
        corrupt_partial &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; partial(corrupt, severity&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;severity, corruption_number&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;corruption_number)
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; sz: transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Compose(
            [
            np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array,
            corrupt_partial,
            Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fromarray,
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Resize(sz),
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ToTensor(), 
            transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normalize(&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;MEAN_STD),
            ]
        )
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; severity &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
            self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;lambda&lt;/span&gt; sz: transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Compose(
                [
                transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Resize(sz),
                transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;ToTensor(), 
                transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normalize(&lt;span style=&#34;color:#f92672&#34;&gt;**&lt;/span&gt;MEAN_STD)   
                ]
            )
        self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;red_size &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; red_size
        
            
    &lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; __call__(self, img):
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fromarray(img)
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; img&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;resize(self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;red_size)
        W,H &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; img&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;size
        sz &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (H,W)
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; img&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;resize((&lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;224&lt;/span&gt;),Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;BILINEAR)
        img &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;transform(sz)(img)
        &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; img
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;generate-the-demo-video&#34;&gt;Generate the demo video&lt;/h3&gt;
&lt;p&gt;Here we equally divide the frames amongst corruptions and processing them through SCrIBE and the baseline models.&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;ns_preds &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
s_preds &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
ims &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
corr_ims &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
corr_txts &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; []
switch &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; videodata&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;//&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;13&lt;/span&gt;
sv &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;
cn &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; 


pbar &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tqdm(enumerate(videodata), total&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;videodata&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])
&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; k, im &lt;span style=&#34;color:#f92672&#34;&gt;in&lt;/span&gt; pbar:
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; k&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;switch&lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;and&lt;/span&gt; k&lt;span style=&#34;color:#f92672&#34;&gt;!=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
        sv &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;
        cn &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;8&lt;/span&gt;:
            cn &lt;span style=&#34;color:#f92672&#34;&gt;+=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;==&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;12&lt;/span&gt;:
            sv &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; cn &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;:
        corr_txts&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(corruption_tuple[cn]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;__name__)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt;:
        corr_txts&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;None&amp;#39;&lt;/span&gt;)
    pbar&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_description(corr_txts[&lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;])
    transform &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ImCorruptTransform(sv,cn, (&lt;span style=&#34;color:#ae81ff&#34;&gt;480&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;270&lt;/span&gt;))
    ims&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;array(transforms&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Resize(&lt;span style=&#34;color:#ae81ff&#34;&gt;270&lt;/span&gt;)(Image&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;fromarray(im))))
    im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; transform(im)
    corr_ims&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;permute([&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;])&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy())
    im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;unsqueeze(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
    
    s_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;))
    s_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; s_pred&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
    s_c_out &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; colorize_voc_label(s_pred)
    s_preds&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(s_c_out[:,:,:,:&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;])
    
    ns_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; no_scribe_model(im&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;to(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;))
    ns_pred &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ns_pred&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;argmax(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;cpu()&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;numpy()
    ns_c_out &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; colorize_voc_label(ns_pred)
    ns_preds&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;append(ns_c_out[:,:,:,:&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;])
ns_preds &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;concatenate(ns_preds)
s_preds &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;concatenate(s_preds)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;h3 id=&#34;animate&#34;&gt;Animate&lt;/h3&gt;
&lt;p&gt;This takes a while. I am sure there is a faster way&amp;hellip;&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span style=&#34;color:#f92672&#34;&gt;as&lt;/span&gt; plt
&lt;span style=&#34;color:#f92672&#34;&gt;from&lt;/span&gt; matplotlib &lt;span style=&#34;color:#f92672&#34;&gt;import&lt;/span&gt; animation, rc
rc(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;animation&amp;#39;&lt;/span&gt;, html&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;html5&amp;#39;&lt;/span&gt;)
&lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt;(ims[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape, corr_ims[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape)
&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;join_ex&lt;/span&gt;(im,corrim,ns_pred,s_pred):
    im &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; im&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;255.0&lt;/span&gt;
    corrim &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; corrim&lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;std&amp;#39;&lt;/span&gt;]&lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt;MEAN_STD[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;]
    corrim &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;clip(corrim,&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;,&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    top &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;concatenate([im, corrim],&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    bot &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;concatenate([ns_pred, s_pred],&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; np&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;concatenate([top,bot], &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;)
    

my_dpi &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;960&lt;/span&gt;
fig, ax &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; plt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,figsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;1920&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;my_dpi, &lt;span style=&#34;color:#ae81ff&#34;&gt;1080&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;my_dpi), dpi&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;my_dpi)
vis &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;imshow(join_ex(ims[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;],corr_ims[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], ns_preds[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], s_preds[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]))
corrtxt &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;500&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;, f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Corruption: None&amp;#39;&lt;/span&gt;, fontsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, color&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;, fontweight&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bold&amp;#39;&lt;/span&gt;)
corrtxt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_path_effects([path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Stroke(linewidth&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, foreground&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;), path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normal()]) 
theirs &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;20&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;300&lt;/span&gt;, f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Theirs&amp;#39;&lt;/span&gt;, fontsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, color&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;, fontweight&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bold&amp;#39;&lt;/span&gt;)
theirs&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_path_effects([path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Stroke(linewidth&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, foreground&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;), path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normal()]) 
ours &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;text(&lt;span style=&#34;color:#ae81ff&#34;&gt;500&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;300&lt;/span&gt;, f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Ours&amp;#39;&lt;/span&gt;, fontsize&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;, color&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;red&amp;#39;&lt;/span&gt;, fontweight&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;bold&amp;#39;&lt;/span&gt;)
ours&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_path_effects([path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Stroke(linewidth&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, foreground&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;black&amp;#39;&lt;/span&gt;), path_effects&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;Normal()]) 

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;animate&lt;/span&gt;(i):
    corrtxt&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_text(f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Corruption: {corr_txts[i]}&amp;#39;&lt;/span&gt;)
    vis&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_array(join_ex(ims[i],corr_ims[i], ns_preds[i], s_preds[i]))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; [vis]

&lt;span style=&#34;color:#66d9ef&#34;&gt;def&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;init&lt;/span&gt;():
    vis&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_array(join_ex(ims[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;],corr_ims[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], ns_preds[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], s_preds[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;]))
    &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; [vis]
    
fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;tight_layout()
fig&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;subplots_adjust(left&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, bottom&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;, right&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, top&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, wspace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;None, hspace&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;None)
ax&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;set_axis_off()
ani &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; animation&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;FuncAnimation(fig, animate, frames&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;s_preds&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;shape[&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;], interval&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;, blit&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;True, init_func&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;init)
    &lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;pre&gt;&lt;code&gt;(270, 480, 3) (270, 480, 3)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;index_58_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;

&lt;style&gt;
 .definition {
     visibility: hidden;
     width: 120px;
     background-color: #555;
     color: #fff;
     text-align: center;
     border-radius: 6px;
     padding: 5px 0;
     position: absolute;
     z-index: 1;
     bottom: 125%;
     left: 50%;
     margin-left: -60px;
     opacity: 0;
     transition: opacity 0.3s;
 }
 
 .term {
     position: relative;
     display: inline-block;
     border-bottom: 1px dotted black;}
 
 .term:hover .definition {
     visibility: visible;
     opacity: 1;
 }
&lt;/style&gt;
&lt;span class=&#34;expand&#34;&gt;
    &lt;span class=&#34;expand-label&#34; style=&#34;cursor: pointer;&#34; onclick=&#34;$h = $(this);$h.next(&#39;div&#39;).slideToggle(100,function () {$h.children(&#39;i&#39;).attr(&#39;class&#39;,function () {return $h.next(&#39;div&#39;).is(&#39;:visible&#39;) ? &#39;fas fa-chevron-down&#39; : &#39;fas fa-fas fa-chevron-right&#39;;});});&#34;&gt;
        show code
        &lt;i class=&#34;fas fa-chevron-right&#34;&gt;&lt;/i&gt;
    &lt;/span&gt;
    &lt;div class=&#34;expand-content&#34; style=&#34;display: none; margin: 10px 0px 10px&#34;&gt;
        &lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;# Set up formatting for the movie files&lt;/span&gt;
Writer &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; animation&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;writers[&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;ffmpeg&amp;#39;&lt;/span&gt;]
writer &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Writer(fps&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;30&lt;/span&gt;, metadata&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;dict(artist&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;Me&amp;#39;&lt;/span&gt;), bitrate&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;18000&lt;/span&gt;)
ani&lt;span style=&#34;color:#f92672&#34;&gt;.&lt;/span&gt;save(f&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;example_videos/scribe_pred_{video}&amp;#39;&lt;/span&gt;, writer&lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt;writer)&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
    &lt;/div&gt;
&lt;/span&gt;

&lt;p&gt;Thank you for making it to the bottom of this post.  I hope you will feel more comfortable reproducing our work.  Please feel free to contact me with any questions or comments.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Robustness and Overfitting Behavior of Implicit Background Models</title>
      <link>https://charlielehman.github.io/publication/robustness-and-overfitting/</link>
      <pubDate>Thu, 01 Oct 2020 00:00:00 +0000</pubDate>
      <guid>https://charlielehman.github.io/publication/robustness-and-overfitting/</guid>
      <description></description>
    </item>
    
    <item>
      <title>S6:Semi-Supervised Self-Supervised Semantic Segmentation</title>
      <link>https://charlielehman.github.io/publication/s6/</link>
      <pubDate>Thu, 01 Oct 2020 00:00:00 +0000</pubDate>
      <guid>https://charlielehman.github.io/publication/s6/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Implicit Background Estimation for Semantic Segmentation</title>
      <link>https://charlielehman.github.io/publication/implicit-background-estimation-for-semantic-segmentation/</link>
      <pubDate>Sun, 01 Sep 2019 00:00:00 +0000</pubDate>
      <guid>https://charlielehman.github.io/publication/implicit-background-estimation-for-semantic-segmentation/</guid>
      <description></description>
    </item>
    
  </channel>
</rss>
